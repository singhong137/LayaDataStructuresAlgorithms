{
  "code": "import { TextAtlas } from \"./TextAtlas\";\r\nimport { TextTexture } from \"./TextTexture\";\r\nimport { Point } from \"../../maths/Point\";\r\nimport { RenderInfo } from \"../../renders/RenderInfo\";\r\nimport { Texture } from \"../../resource/Texture\";\r\nimport { FontInfo } from \"../../utils/FontInfo\";\r\nimport { WordText } from \"../../utils/WordText\";\r\nimport { CharRenderInfo } from \"./CharRenderInfo\";\r\nimport { CharRender_Canvas } from \"./CharRender_Canvas\";\r\nimport { CharRender_Native } from \"./CharRender_Native\";\r\nimport { ILaya } from \"../../../ILaya\";\r\nexport class TextRender {\r\n    constructor() {\r\n        this.fontSizeInfo = {};\r\n        this.mapFont = {};\r\n        this.fontID = 0;\r\n        this.mapColor = [];\r\n        this.colorID = 0;\r\n        this.fontScaleX = 1.0;\r\n        this.fontScaleY = 1.0;\r\n        this._curStrPos = 0;\r\n        this.textAtlases = [];\r\n        this.isoTextures = [];\r\n        this.lastFont = null;\r\n        this.fontSizeW = 0;\r\n        this.fontSizeH = 0;\r\n        this.fontSizeOffX = 0;\r\n        this.fontSizeOffY = 0;\r\n        this.renderPerChar = true;\r\n        this.tmpAtlasPos = new Point();\r\n        this.textureMem = 0;\r\n        ILaya.TextAtlas = TextAtlas;\r\n        var bugIOS = false;\r\n        var miniadp = ILaya.Laya['MiniAdpter'];\r\n        if (miniadp && miniadp.systemInfo && miniadp.systemInfo.system) {\r\n            bugIOS = miniadp.systemInfo.system.toLowerCase() === 'ios 10.1.1';\r\n        }\r\n        if (ILaya.Browser.onMiniGame && !bugIOS)\r\n            TextRender.isWan1Wan = true;\r\n        this.charRender = ILaya.Render.isConchApp ? (new CharRender_Native()) : (new CharRender_Canvas(TextRender.atlasWidth, TextRender.atlasWidth, TextRender.scaleFontWithCtx, !TextRender.isWan1Wan, false));\r\n        TextRender.textRenderInst = this;\r\n        ILaya.Laya['textRender'] = this;\r\n        TextRender.atlasWidth2 = TextRender.atlasWidth * TextRender.atlasWidth;\r\n    }\r\n    setFont(font) {\r\n        if (this.lastFont == font)\r\n            return;\r\n        this.lastFont = font;\r\n        var fontsz = this.getFontSizeInfo(font._family);\r\n        var offx = fontsz >> 24;\r\n        var offy = (fontsz >> 16) & 0xff;\r\n        var fw = (fontsz >> 8) & 0xff;\r\n        var fh = fontsz & 0xff;\r\n        var k = font._size / TextRender.standardFontSize;\r\n        this.fontSizeOffX = Math.ceil(offx * k);\r\n        this.fontSizeOffY = Math.ceil(offy * k);\r\n        this.fontSizeW = Math.ceil(fw * k);\r\n        this.fontSizeH = Math.ceil(fh * k);\r\n        if (font._font.indexOf('italic') >= 0) {\r\n            this.fontStr = font._font.replace('italic', '');\r\n        }\r\n        else {\r\n            this.fontStr = font._font;\r\n        }\r\n    }\r\n    getNextChar(str) {\r\n        var len = str.length;\r\n        var start = this._curStrPos;\r\n        if (start >= len)\r\n            return null;\r\n        var i = start;\r\n        var state = 0;\r\n        for (; i < len; i++) {\r\n            var c = str.charCodeAt(i);\r\n            if ((c >>> 11) == 0x1b) {\r\n                if (state == 1)\r\n                    break;\r\n                state = 1;\r\n                i++;\r\n            }\r\n            else if (c === 0xfe0e || c === 0xfe0f) {\r\n            }\r\n            else if (c == 0x200d) {\r\n                state = 2;\r\n            }\r\n            else {\r\n                if (state == 0)\r\n                    state = 1;\r\n                else if (state == 1)\r\n                    break;\r\n                else if (state == 2) {\r\n                }\r\n            }\r\n        }\r\n        this._curStrPos = i;\r\n        return str.substring(start, i);\r\n    }\r\n    filltext(ctx, data, x, y, fontStr, color, strokeColor, lineWidth, textAlign, underLine = 0) {\r\n        if (data.length <= 0)\r\n            return;\r\n        var font = FontInfo.Parse(fontStr);\r\n        var nTextAlign = 0;\r\n        switch (textAlign) {\r\n            case 'center':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_CENTER;\r\n                break;\r\n            case 'right':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_RIGHT;\r\n                break;\r\n        }\r\n        this._fast_filltext(ctx, data, null, x, y, font, color, strokeColor, lineWidth, nTextAlign, underLine);\r\n    }\r\n    fillWords(ctx, data, x, y, fontStr, color, strokeColor, lineWidth) {\r\n        if (!data)\r\n            return;\r\n        if (data.length <= 0)\r\n            return;\r\n        var font = typeof (fontStr) === 'string' ? FontInfo.Parse(fontStr) : fontStr;\r\n        this._fast_filltext(ctx, null, data, x, y, font, color, strokeColor, lineWidth, 0, 0);\r\n    }\r\n    _fast_filltext(ctx, data, htmlchars, x, y, font, color, strokeColor, lineWidth, textAlign, underLine = 0) {\r\n        if (data && data.length < 1)\r\n            return;\r\n        if (htmlchars && htmlchars.length < 1)\r\n            return;\r\n        if (lineWidth < 0)\r\n            lineWidth = 0;\r\n        this.setFont(font);\r\n        this.fontScaleX = this.fontScaleY = 1.0;\r\n        if (TextRender.scaleFontWithCtx) {\r\n            var sx = 1;\r\n            var sy = 1;\r\n            if (!ILaya.Render.isConchApp || (window.conchTextCanvas.scale)) {\r\n                sx = ctx.getMatScaleX();\r\n                sy = ctx.getMatScaleY();\r\n            }\r\n            if (sx < 1e-4 || sy < 1e-1)\r\n                return;\r\n            if (sx > 1)\r\n                this.fontScaleX = sx;\r\n            if (sy > 1)\r\n                this.fontScaleY = sy;\r\n        }\r\n        font._italic && (ctx._italicDeg = 13);\r\n        var wt = data;\r\n        var isWT = !htmlchars && (data instanceof WordText);\r\n        var str = data;\r\n        var isHtmlChar = !!htmlchars;\r\n        var sameTexData = isWT ? wt.pageChars : [];\r\n        var strWidth = 0;\r\n        if (isWT) {\r\n            str = wt._text;\r\n            strWidth = wt.width;\r\n            if (strWidth < 0) {\r\n                strWidth = wt.width = this.charRender.getWidth(this.fontStr, str);\r\n            }\r\n        }\r\n        else {\r\n            strWidth = str ? this.charRender.getWidth(this.fontStr, str) : 0;\r\n        }\r\n        switch (textAlign) {\r\n            case ILaya.Context.ENUM_TEXTALIGN_CENTER:\r\n                x -= strWidth / 2;\r\n                break;\r\n            case ILaya.Context.ENUM_TEXTALIGN_RIGHT:\r\n                x -= strWidth;\r\n                break;\r\n        }\r\n        if (wt && sameTexData) {\r\n            if (this.hasFreedText(sameTexData)) {\r\n                sameTexData = wt.pageChars = [];\r\n            }\r\n        }\r\n        var ri = null;\r\n        var splitTex = this.renderPerChar = (!isWT) || TextRender.forceSplitRender || isHtmlChar || (isWT && wt.splitRender);\r\n        if (!sameTexData || sameTexData.length < 1) {\r\n            if (isWT) {\r\n                wt.scalex = this.fontScaleX;\r\n                wt.scaley = this.fontScaleY;\r\n            }\r\n            if (splitTex) {\r\n                var stx = 0;\r\n                var sty = 0;\r\n                this._curStrPos = 0;\r\n                var curstr;\r\n                while (true) {\r\n                    if (htmlchars) {\r\n                        var chc = htmlchars[this._curStrPos++];\r\n                        if (chc) {\r\n                            curstr = chc.char;\r\n                            stx = chc.x;\r\n                            sty = chc.y;\r\n                        }\r\n                        else {\r\n                            curstr = null;\r\n                        }\r\n                    }\r\n                    else {\r\n                        curstr = this.getNextChar(str);\r\n                    }\r\n                    if (!curstr)\r\n                        break;\r\n                    ri = this.getCharRenderInfo(curstr, font, color, strokeColor, lineWidth, false);\r\n                    if (!ri) {\r\n                        break;\r\n                    }\r\n                    if (ri.isSpace) {\r\n                    }\r\n                    else {\r\n                        var add = sameTexData[ri.tex.id];\r\n                        if (!add) {\r\n                            var o1 = { texgen: ri.tex.genID, tex: ri.tex, words: [] };\r\n                            sameTexData[ri.tex.id] = o1;\r\n                            add = o1.words;\r\n                        }\r\n                        else {\r\n                            add = add.words;\r\n                        }\r\n                        add.push({ ri: ri, x: stx, y: sty, w: ri.bmpWidth / this.fontScaleX, h: ri.bmpHeight / this.fontScaleY });\r\n                        stx += ri.width;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                var isotex = TextRender.noAtlas || strWidth * this.fontScaleX > TextRender.atlasWidth;\r\n                ri = this.getCharRenderInfo(str, font, color, strokeColor, lineWidth, isotex);\r\n                sameTexData[0] = { texgen: ri.tex.genID, tex: ri.tex, words: [{ ri: ri, x: 0, y: 0, w: ri.bmpWidth / this.fontScaleX, h: ri.bmpHeight / this.fontScaleY }] };\r\n            }\r\n        }\r\n        this._drawResortedWords(ctx, x, y, sameTexData);\r\n        ctx._italicDeg = 0;\r\n    }\r\n    _drawResortedWords(ctx, startx, starty, samePagesData) {\r\n        var isLastRender = ctx._charSubmitCache ? ctx._charSubmitCache._enable : false;\r\n        var mat = ctx._curMat;\r\n        var slen = samePagesData.length;\r\n        for (var id in samePagesData) {\r\n            var dt = samePagesData[id];\r\n            if (!dt)\r\n                continue;\r\n            var pri = dt.words;\r\n            var pisz = pri.length;\r\n            if (pisz <= 0)\r\n                continue;\r\n            var tex = samePagesData[id].tex;\r\n            for (var j = 0; j < pisz; j++) {\r\n                var riSaved = pri[j];\r\n                var ri = riSaved.ri;\r\n                if (ri.isSpace)\r\n                    continue;\r\n                ri.touch();\r\n                ctx.drawTexAlign = true;\r\n                if (ILaya.Render.isConchApp) {\r\n                    ctx._drawTextureM(tex.texture, startx + riSaved.x - ri.orix, starty + riSaved.y - ri.oriy, riSaved.w, riSaved.h, null, 1.0, ri.uv);\r\n                }\r\n                else {\r\n                    let t = tex;\r\n                    ctx._inner_drawTexture(t.texture, t.id, startx + riSaved.x - ri.orix, starty + riSaved.y - ri.oriy, riSaved.w, riSaved.h, mat, ri.uv, 1.0, isLastRender);\r\n                }\r\n                if (ctx.touches) {\r\n                    ctx.touches.push(ri);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    hasFreedText(txts) {\r\n        var sz = txts.length;\r\n        for (var i = 0; i < sz; i++) {\r\n            var pri = txts[i];\r\n            if (!pri)\r\n                continue;\r\n            var tex = pri.tex;\r\n            if (tex.__destroyed || tex.genID != pri.texgen) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    getCharRenderInfo(str, font, color, strokeColor, lineWidth, isoTexture = false) {\r\n        var fid = this.mapFont[font._family];\r\n        if (fid == undefined) {\r\n            this.mapFont[font._family] = fid = this.fontID++;\r\n        }\r\n        var key = str + '_' + fid + '_' + font._size + '_' + color;\r\n        if (lineWidth > 0)\r\n            key += '_' + strokeColor + lineWidth;\r\n        if (font._bold)\r\n            key += 'P';\r\n        if (this.fontScaleX != 1 || this.fontScaleY != 1) {\r\n            key += (this.fontScaleX * 20 | 0) + '_' + (this.fontScaleY * 20 | 0);\r\n        }\r\n        var i = 0;\r\n        var sz = this.textAtlases.length;\r\n        var ri;\r\n        var atlas;\r\n        if (!isoTexture) {\r\n            for (i = 0; i < sz; i++) {\r\n                atlas = this.textAtlases[i];\r\n                ri = atlas.charMaps[key];\r\n                if (ri) {\r\n                    ri.touch();\r\n                    return ri;\r\n                }\r\n            }\r\n        }\r\n        ri = new CharRenderInfo();\r\n        this.charRender.scale(this.fontScaleX, this.fontScaleY);\r\n        ri.char = str;\r\n        ri.height = font._size;\r\n        var margin = ILaya.Render.isConchApp ? 0 : (font._size / 3 | 0);\r\n        var imgdt = null;\r\n        if (!lineWidth) {\r\n            lineWidth = 0;\r\n        }\r\n        var w1 = Math.ceil((this.charRender.getWidth(this.fontStr, str) + 2 * lineWidth) * this.fontScaleX);\r\n        if (w1 > this.charRender.canvasWidth) {\r\n            this.charRender.canvasWidth = Math.min(2048, w1 + margin * 2);\r\n        }\r\n        if (isoTexture) {\r\n            this.charRender.fontsz = font._size;\r\n            imgdt = this.charRender.getCharBmp(str, this.fontStr, lineWidth, color, strokeColor, ri, margin, margin, margin, margin, null);\r\n            if (imgdt) {\r\n                var tex = TextTexture.getTextTexture(imgdt.width, imgdt.height);\r\n                tex.addChar(imgdt, 0, 0, ri.uv);\r\n                ri.tex = tex;\r\n                ri.orix = margin;\r\n                ri.oriy = margin;\r\n                tex.ri = ri;\r\n                this.isoTextures.push(tex);\r\n            }\r\n        }\r\n        else {\r\n            var len = str.length;\r\n            if (len > 1) {\r\n            }\r\n            var lineExt = lineWidth * 1;\r\n            var fw = Math.ceil((this.fontSizeW + lineExt * 2) * this.fontScaleX);\r\n            var fh = Math.ceil((this.fontSizeH + lineExt * 2) * this.fontScaleY);\r\n            TextRender.imgdtRect[0] = ((margin - this.fontSizeOffX - lineExt) * this.fontScaleX) | 0;\r\n            TextRender.imgdtRect[1] = ((margin - this.fontSizeOffY - lineExt) * this.fontScaleY) | 0;\r\n            if (this.renderPerChar || len == 1) {\r\n                TextRender.imgdtRect[2] = Math.max(w1, fw);\r\n                TextRender.imgdtRect[3] = Math.max(w1, fh);\r\n            }\r\n            else {\r\n                TextRender.imgdtRect[2] = -1;\r\n                TextRender.imgdtRect[3] = fh;\r\n            }\r\n            this.charRender.fontsz = font._size;\r\n            imgdt = this.charRender.getCharBmp(str, this.fontStr, lineWidth, color, strokeColor, ri, margin, margin, margin, margin, TextRender.imgdtRect);\r\n            if (imgdt) {\r\n                atlas = this.addBmpData(imgdt, ri);\r\n                if (TextRender.isWan1Wan) {\r\n                    ri.orix = margin;\r\n                    ri.oriy = margin;\r\n                }\r\n                else {\r\n                    ri.orix = (this.fontSizeOffX + lineExt);\r\n                    ri.oriy = (this.fontSizeOffY + lineExt);\r\n                }\r\n                atlas.charMaps[key] = ri;\r\n            }\r\n        }\r\n        return ri;\r\n    }\r\n    addBmpData(data, ri) {\r\n        var w = data.width;\r\n        var h = data.height;\r\n        var sz = this.textAtlases.length;\r\n        var atlas;\r\n        var find = false;\r\n        for (var i = 0; i < sz; i++) {\r\n            atlas = this.textAtlases[i];\r\n            find = atlas.getAEmpty(w, h, this.tmpAtlasPos);\r\n            if (find) {\r\n                break;\r\n            }\r\n        }\r\n        if (!find) {\r\n            atlas = new TextAtlas();\r\n            this.textAtlases.push(atlas);\r\n            find = atlas.getAEmpty(w, h, this.tmpAtlasPos);\r\n            if (!find) {\r\n                throw 'err1';\r\n            }\r\n            this.cleanAtlases();\r\n        }\r\n        if (find) {\r\n            atlas.texture.addChar(data, this.tmpAtlasPos.x, this.tmpAtlasPos.y, ri.uv);\r\n            ri.tex = atlas.texture;\r\n        }\r\n        return atlas;\r\n    }\r\n    GC() {\r\n        var i = 0;\r\n        var sz = this.textAtlases.length;\r\n        var dt = 0;\r\n        var destroyDt = TextRender.destroyAtlasDt;\r\n        var totalUsedRate = 0;\r\n        var totalUsedRateAtlas = 0;\r\n        var curloop = RenderInfo.loopCount;\r\n        var maxWasteRateID = -1;\r\n        var maxWasteRate = 0;\r\n        var tex = null;\r\n        var curatlas = null;\r\n        for (; i < sz; i++) {\r\n            curatlas = this.textAtlases[i];\r\n            tex = curatlas.texture;\r\n            if (tex) {\r\n                totalUsedRate += tex.curUsedCovRate;\r\n                totalUsedRateAtlas += tex.curUsedCovRateAtlas;\r\n                var waste = curatlas.usedRate - tex.curUsedCovRateAtlas;\r\n                if (maxWasteRate < waste) {\r\n                    maxWasteRate = waste;\r\n                    maxWasteRateID = i;\r\n                }\r\n            }\r\n            dt = curloop - curatlas.texture.lastTouchTm;\r\n            if (dt > destroyDt) {\r\n                TextRender.showLog && console.log('TextRender GC delete atlas ' + tex ? curatlas.texture.id : 'unk');\r\n                curatlas.destroy();\r\n                this.textAtlases[i] = this.textAtlases[sz - 1];\r\n                sz--;\r\n                i--;\r\n                maxWasteRateID = -1;\r\n            }\r\n        }\r\n        this.textAtlases.length = sz;\r\n        sz = this.isoTextures.length;\r\n        for (i = 0; i < sz; i++) {\r\n            tex = this.isoTextures[i];\r\n            dt = curloop - tex.lastTouchTm;\r\n            if (dt > TextRender.destroyUnusedTextureDt) {\r\n                tex.ri.deleted = true;\r\n                tex.ri.tex = null;\r\n                tex.destroy();\r\n                this.isoTextures[i] = this.isoTextures[sz - 1];\r\n                sz--;\r\n                i--;\r\n            }\r\n        }\r\n        this.isoTextures.length = sz;\r\n        var needGC = this.textAtlases.length > 1 && this.textAtlases.length - totalUsedRateAtlas >= 2;\r\n        if (TextRender.atlasWidth * TextRender.atlasWidth * 4 * this.textAtlases.length > TextRender.cleanMem || needGC || TextRender.simClean) {\r\n            TextRender.simClean = false;\r\n            TextRender.showLog && console.log('清理使用率低的贴图。总使用率:', totalUsedRateAtlas, ':', this.textAtlases.length, '最差贴图:' + maxWasteRateID);\r\n            if (maxWasteRateID >= 0) {\r\n                curatlas = this.textAtlases[maxWasteRateID];\r\n                curatlas.destroy();\r\n                this.textAtlases[maxWasteRateID] = this.textAtlases[this.textAtlases.length - 1];\r\n                this.textAtlases.length = this.textAtlases.length - 1;\r\n            }\r\n        }\r\n        TextTexture.clean();\r\n    }\r\n    cleanAtlases() {\r\n    }\r\n    getCharBmp(c) {\r\n    }\r\n    checkBmpLine(data, l, sx, ex) {\r\n        if (this.bmpData32.buffer != data.data.buffer) {\r\n            this.bmpData32 = new Uint32Array(data.data.buffer);\r\n        }\r\n        var stpos = data.width * l + sx;\r\n        for (var x = sx; x < ex; x++) {\r\n            if (this.bmpData32[stpos++] != 0)\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n    updateBbx(data, curbbx, onlyH = false) {\r\n        var w = data.width;\r\n        var h = data.height;\r\n        var x = 0;\r\n        var sy = curbbx[1];\r\n        var ey = 0;\r\n        var y = sy;\r\n        if (this.checkBmpLine(data, sy, 0, w)) {\r\n            while (true) {\r\n                y = (sy + ey) / 2 | 0;\r\n                if (y + 1 >= sy) {\r\n                    curbbx[1] = y;\r\n                    break;\r\n                }\r\n                if (this.checkBmpLine(data, y, 0, w)) {\r\n                    sy = y;\r\n                }\r\n                else {\r\n                    ey = y;\r\n                }\r\n            }\r\n        }\r\n        if (curbbx[3] > h)\r\n            curbbx[3] = h;\r\n        else {\r\n            y = sy = curbbx[3];\r\n            ey = h;\r\n            if (this.checkBmpLine(data, sy, 0, w)) {\r\n                while (true) {\r\n                    y = (sy + ey) / 2 | 0;\r\n                    if (y - 1 <= sy) {\r\n                        curbbx[3] = y;\r\n                        break;\r\n                    }\r\n                    if (this.checkBmpLine(data, y, 0, w)) {\r\n                        sy = y;\r\n                    }\r\n                    else {\r\n                        ey = y;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (onlyH)\r\n            return;\r\n        var minx = curbbx[0];\r\n        var stpos = w * curbbx[1];\r\n        for (y = curbbx[1]; y < curbbx[3]; y++) {\r\n            for (x = 0; x < minx; x++) {\r\n                if (this.bmpData32[stpos + x] != 0) {\r\n                    minx = x;\r\n                    break;\r\n                }\r\n            }\r\n            stpos += w;\r\n        }\r\n        curbbx[0] = minx;\r\n        var maxx = curbbx[2];\r\n        stpos = w * curbbx[1];\r\n        for (y = curbbx[1]; y < curbbx[3]; y++) {\r\n            for (x = maxx; x < w; x++) {\r\n                if (this.bmpData32[stpos + x] != 0) {\r\n                    maxx = x;\r\n                    break;\r\n                }\r\n            }\r\n            stpos += w;\r\n        }\r\n        curbbx[2] = maxx;\r\n    }\r\n    getFontSizeInfo(font) {\r\n        var finfo = this.fontSizeInfo[font];\r\n        if (finfo != undefined)\r\n            return finfo;\r\n        var fontstr = 'bold ' + TextRender.standardFontSize + 'px ' + font;\r\n        if (TextRender.isWan1Wan) {\r\n            this.fontSizeW = this.charRender.getWidth(fontstr, '有') * 1.5;\r\n            this.fontSizeH = TextRender.standardFontSize * 1.5;\r\n            var szinfo = this.fontSizeW << 8 | this.fontSizeH;\r\n            this.fontSizeInfo[font] = szinfo;\r\n            return szinfo;\r\n        }\r\n        TextRender.pixelBBX[0] = TextRender.standardFontSize / 2;\r\n        TextRender.pixelBBX[1] = TextRender.standardFontSize / 2;\r\n        TextRender.pixelBBX[2] = TextRender.standardFontSize;\r\n        TextRender.pixelBBX[3] = TextRender.standardFontSize;\r\n        var orix = 16;\r\n        var oriy = 16;\r\n        var marginr = 16;\r\n        var marginb = 16;\r\n        this.charRender.scale(1, 1);\r\n        TextRender.tmpRI.height = TextRender.standardFontSize;\r\n        this.charRender.fontsz = TextRender.standardFontSize;\r\n        var bmpdt = this.charRender.getCharBmp('g', fontstr, 0, 'red', null, TextRender.tmpRI, orix, oriy, marginr, marginb);\r\n        if (ILaya.Render.isConchApp) {\r\n            bmpdt.data = new Uint8ClampedArray(bmpdt.data);\r\n        }\r\n        this.bmpData32 = new Uint32Array(bmpdt.data.buffer);\r\n        this.updateBbx(bmpdt, TextRender.pixelBBX, false);\r\n        bmpdt = this.charRender.getCharBmp('有', fontstr, 0, 'red', null, TextRender.tmpRI, oriy, oriy, marginr, marginb);\r\n        if (ILaya.Render.isConchApp) {\r\n            bmpdt.data = new Uint8ClampedArray(bmpdt.data);\r\n        }\r\n        this.bmpData32 = new Uint32Array(bmpdt.data.buffer);\r\n        if (TextRender.pixelBBX[2] < orix + TextRender.tmpRI.width)\r\n            TextRender.pixelBBX[2] = orix + TextRender.tmpRI.width;\r\n        this.updateBbx(bmpdt, TextRender.pixelBBX, false);\r\n        if (ILaya.Render.isConchApp) {\r\n            orix = 0;\r\n            oriy = 0;\r\n        }\r\n        var xoff = Math.max(orix - TextRender.pixelBBX[0], 0);\r\n        var yoff = Math.max(oriy - TextRender.pixelBBX[1], 0);\r\n        var bbxw = TextRender.pixelBBX[2] - TextRender.pixelBBX[0];\r\n        var bbxh = TextRender.pixelBBX[3] - TextRender.pixelBBX[1];\r\n        var sizeinfo = xoff << 24 | yoff << 16 | bbxw << 8 | bbxh;\r\n        this.fontSizeInfo[font] = sizeinfo;\r\n        return sizeinfo;\r\n    }\r\n    printDbgInfo() {\r\n        console.log('图集个数:' + this.textAtlases.length + ',每个图集大小:' + TextRender.atlasWidth + 'x' + TextRender.atlasWidth, ' 用canvas:', TextRender.isWan1Wan);\r\n        console.log('图集占用空间:' + (TextRender.atlasWidth * TextRender.atlasWidth * 4 / 1024 / 1024 * this.textAtlases.length) + 'M');\r\n        console.log('缓存用到的字体:');\r\n        for (var f in this.mapFont) {\r\n            var fontsz = this.getFontSizeInfo(f);\r\n            var offx = fontsz >> 24;\r\n            var offy = (fontsz >> 16) & 0xff;\r\n            var fw = (fontsz >> 8) & 0xff;\r\n            var fh = fontsz & 0xff;\r\n            console.log('    ' + f, ' off:', offx, offy, ' size:', fw, fh);\r\n        }\r\n        var num = 0;\r\n        console.log('缓存数据:');\r\n        var totalUsedRate = 0;\r\n        var totalUsedRateAtlas = 0;\r\n        this.textAtlases.forEach(function (a) {\r\n            var id = a.texture.id;\r\n            var dt = RenderInfo.loopCount - a.texture.lastTouchTm;\r\n            var dtstr = dt > 0 ? ('' + dt + '帧以前') : '当前帧';\r\n            totalUsedRate += a.texture.curUsedCovRate;\r\n            totalUsedRateAtlas += a.texture.curUsedCovRateAtlas;\r\n            console.log('--图集(id:' + id + ',当前使用率:' + (a.texture.curUsedCovRate * 1000 | 0) + '‰', '当前图集使用率:', (a.texture.curUsedCovRateAtlas * 100 | 0) + '%', '图集使用率:', (a.usedRate * 100 | 0), '%, 使用于:' + dtstr + ')--:');\r\n            for (var k in a.charMaps) {\r\n                var ri = a.charMaps[k];\r\n                console.log('     off:', ri.orix, ri.oriy, ' bmp宽高:', ri.bmpWidth, ri.bmpHeight, '无效:', ri.deleted, 'touchdt:', (RenderInfo.loopCount - ri.touchTick), '位置:', ri.uv[0] * TextRender.atlasWidth | 0, ri.uv[1] * TextRender.atlasWidth | 0, '字符:', ri.char, 'key:', k);\r\n                num++;\r\n            }\r\n        });\r\n        console.log('独立贴图文字(' + this.isoTextures.length + '个):');\r\n        this.isoTextures.forEach(function (tex) {\r\n            console.log('    size:', tex._texW, tex._texH, 'touch间隔:', (RenderInfo.loopCount - tex.lastTouchTm), 'char:', tex.ri.char);\r\n        });\r\n        console.log('总缓存:', num, '总使用率:', totalUsedRate, '总当前图集使用率:', totalUsedRateAtlas);\r\n    }\r\n    showAtlas(n, bgcolor, x, y, w, h) {\r\n        if (!this.textAtlases[n]) {\r\n            console.log('没有这个图集');\r\n            return null;\r\n        }\r\n        var sp = new ILaya.Sprite();\r\n        var texttex = this.textAtlases[n].texture;\r\n        var texture = {\r\n            width: TextRender.atlasWidth,\r\n            height: TextRender.atlasWidth,\r\n            sourceWidth: TextRender.atlasWidth,\r\n            sourceHeight: TextRender.atlasWidth,\r\n            offsetX: 0,\r\n            offsetY: 0,\r\n            getIsReady: function () { return true; },\r\n            _addReference: function () { },\r\n            _removeReference: function () { },\r\n            _getSource: function () { return texttex._getSource(); },\r\n            bitmap: { id: texttex.id },\r\n            _uv: Texture.DEF_UV\r\n        };\r\n        sp.size = function (w, h) {\r\n            this.width = w;\r\n            this.height = h;\r\n            sp.graphics.clear();\r\n            sp.graphics.drawRect(0, 0, sp.width, sp.height, bgcolor);\r\n            sp.graphics.drawTexture(texture, 0, 0, sp.width, sp.height);\r\n            return this;\r\n        };\r\n        sp.graphics.drawRect(0, 0, w, h, bgcolor);\r\n        sp.graphics.drawTexture(texture, 0, 0, w, h);\r\n        sp.pos(x, y);\r\n        ILaya.stage.addChild(sp);\r\n        return sp;\r\n    }\r\n    filltext_native(ctx, data, htmlchars, x, y, fontStr, color, strokeColor, lineWidth, textAlign, underLine = 0) {\r\n        if (data && data.length <= 0)\r\n            return;\r\n        if (htmlchars && htmlchars.length < 1)\r\n            return;\r\n        var font = FontInfo.Parse(fontStr);\r\n        var nTextAlign = 0;\r\n        switch (textAlign) {\r\n            case 'center':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_CENTER;\r\n                break;\r\n            case 'right':\r\n                nTextAlign = ILaya.Context.ENUM_TEXTALIGN_RIGHT;\r\n                break;\r\n        }\r\n        return this._fast_filltext(ctx, data, htmlchars, x, y, font, color, strokeColor, lineWidth, nTextAlign, underLine);\r\n    }\r\n}\r\nTextRender.useOldCharBook = false;\r\nTextRender.atlasWidth = 1024;\r\nTextRender.noAtlas = false;\r\nTextRender.forceSplitRender = false;\r\nTextRender.forceWholeRender = false;\r\nTextRender.scaleFontWithCtx = true;\r\nTextRender.standardFontSize = 32;\r\nTextRender.destroyAtlasDt = 10;\r\nTextRender.checkCleanTextureDt = 2000;\r\nTextRender.destroyUnusedTextureDt = 3000;\r\nTextRender.cleanMem = 100 * 1024 * 1024;\r\nTextRender.isWan1Wan = false;\r\nTextRender.showLog = false;\r\nTextRender.debugUV = false;\r\nTextRender.tmpRI = new CharRenderInfo();\r\nTextRender.pixelBBX = [0, 0, 0, 0];\r\nTextRender.imgdtRect = [0, 0, 0, 0];\r\nTextRender.simClean = false;\r\nTextTexture.gTextRender = TextRender;\r\n//# sourceMappingURL=TextRender.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/text/TextAtlas.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/text/TextTexture.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/display/Sprite.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/maths/Matrix.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/maths/Point.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/renders/RenderInfo.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/Context.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/Texture.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/utils/FontInfo.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/utils/HTMLChar.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/utils/WordText.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/text/CharRenderInfo.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/text/CharRender_Canvas.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/text/CharRender_Native.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/text/ICharRender.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/ILaya.ts"
  ],
  "map": "{\"version\":3,\"file\":\"TextRender.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../libs/laya/webgl/text/TextRender.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/webgl/text/TextRender.d.ts",
    "writeByteOrderMark": false,
    "text": "import { TextAtlas } from \"./TextAtlas\";\r\nimport { Sprite } from \"../../display/Sprite\";\r\nimport { Context } from \"../../resource/Context\";\r\nimport { FontInfo } from \"../../utils/FontInfo\";\r\nimport { HTMLChar } from \"../../utils/HTMLChar\";\r\nimport { WordText } from \"../../utils/WordText\";\r\nimport { CharRenderInfo } from \"./CharRenderInfo\";\r\nexport declare class TextRender {\r\n    static useOldCharBook: boolean;\r\n    static atlasWidth: number;\r\n    static noAtlas: boolean;\r\n    static forceSplitRender: boolean;\r\n    static forceWholeRender: boolean;\r\n    static scaleFontWithCtx: boolean;\r\n    static standardFontSize: number;\r\n    static destroyAtlasDt: number;\r\n    static checkCleanTextureDt: number;\r\n    static destroyUnusedTextureDt: number;\r\n    static cleanMem: number;\r\n    static isWan1Wan: boolean;\r\n    static showLog: boolean;\r\n    static debugUV: boolean;\r\n    private fontSizeInfo;\r\n    static atlasWidth2: number;\r\n    private charRender;\r\n    private static tmpRI;\r\n    private static pixelBBX;\r\n    private mapFont;\r\n    private fontID;\r\n    private mapColor;\r\n    private colorID;\r\n    private fontScaleX;\r\n    private fontScaleY;\r\n    private _curStrPos;\r\n    static textRenderInst: TextRender;\r\n    textAtlases: TextAtlas[];\r\n    private isoTextures;\r\n    private bmpData32;\r\n    private static imgdtRect;\r\n    private lastFont;\r\n    private fontSizeW;\r\n    private fontSizeH;\r\n    private fontSizeOffX;\r\n    private fontSizeOffY;\r\n    private renderPerChar;\r\n    private tmpAtlasPos;\r\n    private textureMem;\r\n    private fontStr;\r\n    static simClean: boolean;\r\n    constructor();\r\n    setFont(font: FontInfo): void;\r\n    getNextChar(str: string): string | null;\r\n    filltext(ctx: Context, data: string | WordText, x: number, y: number, fontStr: string, color: string, strokeColor: string, lineWidth: number, textAlign: string, underLine?: number): void;\r\n    fillWords(ctx: Context, data: HTMLChar[], x: number, y: number, fontStr: string | FontInfo, color: string, strokeColor: string, lineWidth: number): void;\r\n    _fast_filltext(ctx: Context, data: string | WordText | null, htmlchars: HTMLChar[] | null, x: number, y: number, font: FontInfo, color: string, strokeColor: string, lineWidth: number, textAlign: number, underLine?: number): void;\r\n    protected _drawResortedWords(ctx: Context, startx: number, starty: number, samePagesData: any[]): void;\r\n    hasFreedText(txts: any[]): boolean;\r\n    getCharRenderInfo(str: string, font: FontInfo, color: string, strokeColor: string, lineWidth: number, isoTexture?: boolean): CharRenderInfo;\r\n    addBmpData(data: ImageData, ri: CharRenderInfo): TextAtlas;\r\n    GC(): void;\r\n    cleanAtlases(): void;\r\n    getCharBmp(c: string): any;\r\n    private checkBmpLine;\r\n    private updateBbx;\r\n    getFontSizeInfo(font: string): number;\r\n    printDbgInfo(): void;\r\n    showAtlas(n: number, bgcolor: string, x: number, y: number, w: number, h: number): Sprite;\r\n    filltext_native(ctx: Context, data: string | WordText, htmlchars: HTMLChar[], x: number, y: number, fontStr: string, color: string, strokeColor: string, lineWidth: number, textAlign: string, underLine?: number): void;\r\n}\r\n"
  }
}
