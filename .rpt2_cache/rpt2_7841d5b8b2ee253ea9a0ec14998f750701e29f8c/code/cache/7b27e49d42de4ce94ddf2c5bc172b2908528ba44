{
  "code": "import { ILaya } from \"../../ILaya\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { URL } from \"../net/URL\";\r\nexport class Resource extends EventDispatcher {\r\n    constructor() {\r\n        super();\r\n        this._id = 0;\r\n        this._url = null;\r\n        this._cpuMemory = 0;\r\n        this._gpuMemory = 0;\r\n        this._destroyed = false;\r\n        this._referenceCount = 0;\r\n        this.lock = false;\r\n        this.name = null;\r\n        this._id = ++Resource._uniqueIDCounter;\r\n        this._destroyed = false;\r\n        this._referenceCount = 0;\r\n        Resource._idResourcesMap[this.id] = this;\r\n        this.lock = false;\r\n    }\r\n    static get cpuMemory() {\r\n        return Resource._cpuMemory;\r\n    }\r\n    static get gpuMemory() {\r\n        return Resource._gpuMemory;\r\n    }\r\n    static _addCPUMemory(size) {\r\n        Resource._cpuMemory += size;\r\n    }\r\n    static _addGPUMemory(size) {\r\n        Resource._gpuMemory += size;\r\n    }\r\n    static _addMemory(cpuSize, gpuSize) {\r\n        Resource._cpuMemory += cpuSize;\r\n        Resource._gpuMemory += gpuSize;\r\n    }\r\n    static getResourceByID(id) {\r\n        return Resource._idResourcesMap[id];\r\n    }\r\n    static getResourceByURL(url, index = 0) {\r\n        return Resource._urlResourcesMap[url][index];\r\n    }\r\n    static destroyUnusedResources() {\r\n        for (var k in Resource._idResourcesMap) {\r\n            var res = Resource._idResourcesMap[k];\r\n            if (!res.lock && res._referenceCount === 0)\r\n                res.destroy();\r\n        }\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    get url() {\r\n        return this._url;\r\n    }\r\n    get cpuMemory() {\r\n        return this._cpuMemory;\r\n    }\r\n    get gpuMemory() {\r\n        return this._gpuMemory;\r\n    }\r\n    get destroyed() {\r\n        return this._destroyed;\r\n    }\r\n    get referenceCount() {\r\n        return this._referenceCount;\r\n    }\r\n    _setCPUMemory(value) {\r\n        var offsetValue = value - this._cpuMemory;\r\n        this._cpuMemory = value;\r\n        Resource._addCPUMemory(offsetValue);\r\n    }\r\n    _setGPUMemory(value) {\r\n        var offsetValue = value - this._gpuMemory;\r\n        this._gpuMemory = value;\r\n        Resource._addGPUMemory(offsetValue);\r\n    }\r\n    _setCreateURL(url) {\r\n        url = URL.formatURL(url);\r\n        if (this._url !== url) {\r\n            var resList;\r\n            if (this._url) {\r\n                resList = Resource._urlResourcesMap[this._url];\r\n                resList.splice(resList.indexOf(this), 1);\r\n                (resList.length === 0) && (delete Resource._urlResourcesMap[this._url]);\r\n            }\r\n            if (url) {\r\n                resList = Resource._urlResourcesMap[url];\r\n                (resList) || (Resource._urlResourcesMap[url] = resList = []);\r\n                resList.push(this);\r\n            }\r\n            this._url = url;\r\n        }\r\n    }\r\n    _addReference(count = 1) {\r\n        this._referenceCount += count;\r\n    }\r\n    _removeReference(count = 1) {\r\n        this._referenceCount -= count;\r\n    }\r\n    _clearReference() {\r\n        this._referenceCount = 0;\r\n    }\r\n    _recoverResource() {\r\n    }\r\n    _disposeResource() {\r\n    }\r\n    _activeResource() {\r\n    }\r\n    destroy() {\r\n        if (this._destroyed)\r\n            return;\r\n        this._destroyed = true;\r\n        this.lock = false;\r\n        this._disposeResource();\r\n        delete Resource._idResourcesMap[this.id];\r\n        var resList;\r\n        if (this._url) {\r\n            resList = Resource._urlResourcesMap[this._url];\r\n            if (resList) {\r\n                resList.splice(resList.indexOf(this), 1);\r\n                (resList.length === 0) && (delete Resource._urlResourcesMap[this._url]);\r\n            }\r\n            var resou = ILaya.Loader.loadedMap[this._url];\r\n            (resou == this) && (delete ILaya.Loader.loadedMap[this._url]);\r\n        }\r\n    }\r\n}\r\nResource._uniqueIDCounter = 0;\r\nResource._idResourcesMap = {};\r\nResource._urlResourcesMap = {};\r\nResource._cpuMemory = 0;\r\nResource._gpuMemory = 0;\r\n//# sourceMappingURL=Resource.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/ILaya.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/events/EventDispatcher.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/net/URL.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/ICreateResource.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/IDestroy.ts"
  ],
  "map": "{\"version\":3,\"file\":\"Resource.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../libs/laya/resource/Resource.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/resource/Resource.d.ts",
    "writeByteOrderMark": false,
    "text": "import { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { ICreateResource } from \"./ICreateResource\";\r\nimport { IDestroy } from \"./IDestroy\";\r\nexport declare class Resource extends EventDispatcher implements ICreateResource, IDestroy {\r\n    private static _uniqueIDCounter;\r\n    private static _idResourcesMap;\r\n    private static _urlResourcesMap;\r\n    private static _cpuMemory;\r\n    private static _gpuMemory;\r\n    static readonly cpuMemory: number;\r\n    static readonly gpuMemory: number;\r\n    static _addCPUMemory(size: number): void;\r\n    static _addGPUMemory(size: number): void;\r\n    static _addMemory(cpuSize: number, gpuSize: number): void;\r\n    static getResourceByID(id: number): Resource;\r\n    static getResourceByURL(url: string, index?: number): Resource;\r\n    static destroyUnusedResources(): void;\r\n    protected _id: number;\r\n    private _url;\r\n    private _cpuMemory;\r\n    private _gpuMemory;\r\n    private _destroyed;\r\n    protected _referenceCount: number;\r\n    lock: boolean;\r\n    name: string;\r\n    readonly id: number;\r\n    readonly url: string;\r\n    readonly cpuMemory: number;\r\n    readonly gpuMemory: number;\r\n    readonly destroyed: boolean;\r\n    readonly referenceCount: number;\r\n    constructor();\r\n    _setCPUMemory(value: number): void;\r\n    _setGPUMemory(value: number): void;\r\n    _setCreateURL(url: string): void;\r\n    _addReference(count?: number): void;\r\n    _removeReference(count?: number): void;\r\n    _clearReference(): void;\r\n    protected _recoverResource(): void;\r\n    protected _disposeResource(): void;\r\n    protected _activeResource(): void;\r\n    destroy(): void;\r\n}\r\n"
  }
}
