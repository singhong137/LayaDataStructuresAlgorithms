{
  "code": "import { SubmitKey } from \"./SubmitKey\";\r\nimport { Stat } from \"../../utils/Stat\";\r\nimport { WebGLContext } from \"../WebGLContext\";\r\nimport { BlendMode } from \"../canvas/BlendMode\";\r\nimport { CONST3D2D } from \"../utils/CONST3D2D\";\r\nexport class SubmitTarget {\r\n    constructor() {\r\n        this.blendType = 0;\r\n        this._ref = 1;\r\n        this._key = new SubmitKey();\r\n    }\r\n    renderSubmit() {\r\n        var gl = WebGLContext.mainContext;\r\n        this._mesh.useMesh(gl);\r\n        var target = this.srcRT;\r\n        if (target) {\r\n            this.shaderValue.texture = target._getSource();\r\n            this.shaderValue.upload();\r\n            this.blend();\r\n            Stat.renderBatches++;\r\n            Stat.trianglesFaces += this._numEle / 3;\r\n            gl.drawElements(gl.TRIANGLES, this._numEle, gl.UNSIGNED_SHORT, this._startIdx);\r\n        }\r\n        return 1;\r\n    }\r\n    blend() {\r\n        if (BlendMode.activeBlendFunction !== BlendMode.fns[this.blendType]) {\r\n            var gl = WebGLContext.mainContext;\r\n            gl.enable(gl.BLEND);\r\n            BlendMode.fns[this.blendType](gl);\r\n            BlendMode.activeBlendFunction = BlendMode.fns[this.blendType];\r\n        }\r\n    }\r\n    getRenderType() {\r\n        return 0;\r\n    }\r\n    releaseRender() {\r\n        if ((--this._ref) < 1) {\r\n            var pool = SubmitTarget.POOL;\r\n            pool[pool._length++] = this;\r\n        }\r\n    }\r\n    static create(context, mesh, sv, rt) {\r\n        var o = SubmitTarget.POOL._length ? SubmitTarget.POOL[--SubmitTarget.POOL._length] : new SubmitTarget();\r\n        o._mesh = mesh;\r\n        o.srcRT = rt;\r\n        o._startIdx = mesh.indexNum * CONST3D2D.BYTES_PIDX;\r\n        o._ref = 1;\r\n        o._key.clear();\r\n        o._numEle = 0;\r\n        o.blendType = context._nBlendType;\r\n        o._key.blendShader = o.blendType;\r\n        o.shaderValue = sv;\r\n        o.shaderValue.setValue(context._shader2D);\r\n        if (context._colorFiler) {\r\n            var ft = context._colorFiler;\r\n            sv.defines.add(ft.type);\r\n            sv.colorMat = ft._mat;\r\n            sv.colorAlpha = ft._alpha;\r\n        }\r\n        return o;\r\n    }\r\n}\r\nSubmitTarget.POOL = [];\r\n{\r\n    SubmitTarget.POOL._length = 0;\r\n}\r\n//# sourceMappingURL=SubmitTarget.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/submit/ISubmit.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/submit/SubmitKey.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/filters/ColorFilter.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/Context.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/RenderTexture2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/utils/Stat.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/WebGLContext.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/canvas/BlendMode.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/shader/d2/value/TextureSV.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/shader/d2/value/Value2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/CONST3D2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/Mesh2D.ts"
  ],
  "map": "{\"version\":3,\"file\":\"SubmitTarget.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../libs/laya/webgl/submit/SubmitTarget.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/webgl/submit/SubmitTarget.d.ts",
    "writeByteOrderMark": false,
    "text": "import { ISubmit } from \"./ISubmit\";\r\nimport { SubmitKey } from \"./SubmitKey\";\r\nimport { Context } from \"../../resource/Context\";\r\nimport { RenderTexture2D } from \"../../resource/RenderTexture2D\";\r\nimport { Value2D } from \"../shader/d2/value/Value2D\";\r\nimport { Mesh2D } from \"../utils/Mesh2D\";\r\nexport declare class SubmitTarget implements ISubmit {\r\n    _mesh: Mesh2D;\r\n    _startIdx: number;\r\n    _numEle: number;\r\n    shaderValue: Value2D;\r\n    blendType: number;\r\n    _ref: number;\r\n    _key: SubmitKey;\r\n    srcRT: RenderTexture2D;\r\n    constructor();\r\n    static POOL: any;\r\n    renderSubmit(): number;\r\n    blend(): void;\r\n    getRenderType(): number;\r\n    releaseRender(): void;\r\n    static create(context: Context, mesh: Mesh2D, sv: Value2D, rt: RenderTexture2D): SubmitTarget;\r\n}\r\n"
  }
}
