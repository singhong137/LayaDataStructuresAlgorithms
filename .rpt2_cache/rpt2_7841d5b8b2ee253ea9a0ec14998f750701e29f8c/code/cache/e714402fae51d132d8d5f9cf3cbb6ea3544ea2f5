{
  "code": "import { Matrix } from \"../../maths/Matrix\";\r\nimport { SubmitBase } from \"../submit/SubmitBase\";\r\nimport { MeshQuadTexture } from \"../utils/MeshQuadTexture\";\r\nimport { MeshTexture } from \"../utils/MeshTexture\";\r\nimport { MeshVG } from \"../utils/MeshVG\";\r\nexport class WebGLCacheAsNormalCanvas {\r\n    constructor(ctx, sp) {\r\n        this.submitStartPos = 0;\r\n        this.submitEndPos = 0;\r\n        this.context = null;\r\n        this.touches = [];\r\n        this.submits = [];\r\n        this.sprite = null;\r\n        this.meshlist = [];\r\n        this.cachedClipInfo = new Matrix();\r\n        this.oldTx = 0;\r\n        this.oldTy = 0;\r\n        this.invMat = new Matrix();\r\n        this.context = ctx;\r\n        this.sprite = sp;\r\n        ctx._globalClipMatrix.copyTo(this.cachedClipInfo);\r\n    }\r\n    startRec() {\r\n        if (this.context._charSubmitCache._enable) {\r\n            this.context._charSubmitCache.enable(false, this.context);\r\n            this.context._charSubmitCache.enable(true, this.context);\r\n        }\r\n        this.context._incache = true;\r\n        this.touches.length = 0;\r\n        this.context.touches = this.touches;\r\n        this.context._globalClipMatrix.copyTo(this.cachedClipInfo);\r\n        this.submits.length = 0;\r\n        this.submitStartPos = this.context._submits._length;\r\n        for (var i = 0, sz = this.meshlist.length; i < sz; i++) {\r\n            var curm = this.meshlist[i];\r\n            curm.canReuse ? (curm.releaseMesh()) : (curm.destroy());\r\n        }\r\n        this.meshlist.length = 0;\r\n        this._mesh = MeshQuadTexture.getAMesh(false);\r\n        this._pathMesh = MeshVG.getAMesh(false);\r\n        this._triangleMesh = MeshTexture.getAMesh(false);\r\n        this.meshlist.push(this._mesh);\r\n        this.meshlist.push(this._pathMesh);\r\n        this.meshlist.push(this._triangleMesh);\r\n        this.context._curSubmit = SubmitBase.RENDERBASE;\r\n        this._oldMesh = this.context._mesh;\r\n        this._oldPathMesh = this.context._pathMesh;\r\n        this._oldTriMesh = this.context._triangleMesh;\r\n        this._oldMeshList = this.context.meshlist;\r\n        this.context._mesh = this._mesh;\r\n        this.context._pathMesh = this._pathMesh;\r\n        this.context._triangleMesh = this._triangleMesh;\r\n        this.context.meshlist = this.meshlist;\r\n        this.oldTx = this.context._curMat.tx;\r\n        this.oldTy = this.context._curMat.ty;\r\n        this.context._curMat.tx = 0;\r\n        this.context._curMat.ty = 0;\r\n        this.context._curMat.copyTo(this.invMat);\r\n        this.invMat.invert();\r\n    }\r\n    endRec() {\r\n        if (this.context._charSubmitCache._enable) {\r\n            this.context._charSubmitCache.enable(false, this.context);\r\n            this.context._charSubmitCache.enable(true, this.context);\r\n        }\r\n        var parsubmits = this.context._submits;\r\n        this.submitEndPos = parsubmits._length;\r\n        var num = this.submitEndPos - this.submitStartPos;\r\n        for (var i = 0; i < num; i++) {\r\n            this.submits.push(parsubmits[this.submitStartPos + i]);\r\n        }\r\n        parsubmits._length -= num;\r\n        this.context._mesh = this._oldMesh;\r\n        this.context._pathMesh = this._oldPathMesh;\r\n        this.context._triangleMesh = this._oldTriMesh;\r\n        this.context.meshlist = this._oldMeshList;\r\n        this.context._curSubmit = SubmitBase.RENDERBASE;\r\n        this.context._curMat.tx = this.oldTx;\r\n        this.context._curMat.ty = this.oldTy;\r\n        this.context.touches = null;\r\n        this.context._incache = false;\r\n    }\r\n    isCacheValid() {\r\n        var curclip = this.context._globalClipMatrix;\r\n        if (curclip.a != this.cachedClipInfo.a || curclip.b != this.cachedClipInfo.b || curclip.c != this.cachedClipInfo.c\r\n            || curclip.d != this.cachedClipInfo.d || curclip.tx != this.cachedClipInfo.tx || curclip.ty != this.cachedClipInfo.ty)\r\n            return false;\r\n        return true;\r\n    }\r\n    flushsubmit() {\r\n        var curSubmit = SubmitBase.RENDERBASE;\r\n        this.submits.forEach(function (subm) {\r\n            if (subm == SubmitBase.RENDERBASE)\r\n                return;\r\n            SubmitBase.preRender = curSubmit;\r\n            curSubmit = subm;\r\n            subm.renderSubmit();\r\n        });\r\n    }\r\n    releaseMem() {\r\n    }\r\n}\r\nWebGLCacheAsNormalCanvas.matI = new Matrix();\r\n//# sourceMappingURL=WebGLCacheAsNormalCanvas.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/display/Sprite.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/maths/Matrix.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/Context.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/submit/Submit.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/submit/SubmitBase.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/Mesh2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/MeshQuadTexture.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/MeshTexture.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/MeshVG.ts"
  ],
  "map": "{\"version\":3,\"file\":\"WebGLCacheAsNormalCanvas.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../libs/laya/webgl/canvas/WebGLCacheAsNormalCanvas.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/webgl/canvas/WebGLCacheAsNormalCanvas.d.ts",
    "writeByteOrderMark": false,
    "text": "import { Sprite } from \"../../display/Sprite\";\r\nimport { Matrix } from \"../../maths/Matrix\";\r\nimport { Context } from \"../../resource/Context\";\r\nimport { MeshQuadTexture } from \"../utils/MeshQuadTexture\";\r\nexport declare class WebGLCacheAsNormalCanvas {\r\n    submitStartPos: number;\r\n    submitEndPos: number;\r\n    context: Context;\r\n    touches: any[];\r\n    submits: any[];\r\n    sprite: Sprite;\r\n    _mesh: MeshQuadTexture;\r\n    private _pathMesh;\r\n    private _triangleMesh;\r\n    meshlist: any[];\r\n    private _oldMesh;\r\n    private _oldPathMesh;\r\n    private _oldTriMesh;\r\n    private _oldMeshList;\r\n    private cachedClipInfo;\r\n    private oldTx;\r\n    private oldTy;\r\n    private static matI;\r\n    invMat: Matrix;\r\n    constructor(ctx: Context, sp: Sprite);\r\n    startRec(): void;\r\n    endRec(): void;\r\n    isCacheValid(): boolean;\r\n    flushsubmit(): void;\r\n    releaseMem(): void;\r\n}\r\n"
  }
}
