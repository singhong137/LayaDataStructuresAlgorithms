{
  "code": "import { ILaya } from \"./../../ILaya\";\r\nimport { Config } from \"./../../Config\";\r\nimport { LayaGL } from \"../layagl/LayaGL\";\r\nimport { Context } from \"../resource/Context\";\r\nimport { WebGL } from \"../webgl/WebGL\";\r\nimport { WebGLContext } from \"../webgl/WebGLContext\";\r\nimport { BlendMode } from \"../webgl/canvas/BlendMode\";\r\nimport { Shader2D } from \"../webgl/shader/d2/Shader2D\";\r\nimport { ShaderDefines2D } from \"../webgl/shader/d2/ShaderDefines2D\";\r\nimport { Value2D } from \"../webgl/shader/d2/value/Value2D\";\r\nimport { Buffer2D } from \"../webgl/utils/Buffer2D\";\r\nimport { SubmitBase } from \"../webgl/submit/SubmitBase\";\r\nimport { LayaGPU } from \"../webgl/LayaGPU\";\r\nimport { Browser } from \"../utils/Browser\";\r\nexport class Render {\r\n    constructor(width, height, mainCanv) {\r\n        this._timeId = 0;\r\n        Render._mainCanvas = mainCanv;\r\n        let source = Render._mainCanvas.source;\r\n        source.id = \"layaCanvas\";\r\n        source.width = width;\r\n        source.height = height;\r\n        if (Render.isConchApp) {\r\n            document.body.appendChild(source);\r\n        }\r\n        this.initRender(Render._mainCanvas, width, height);\r\n        window.requestAnimationFrame(loop);\r\n        function loop(stamp) {\r\n            ILaya.stage._loop();\r\n            window.requestAnimationFrame(loop);\r\n        }\r\n        ILaya.stage.on(\"visibilitychange\", this, this._onVisibilitychange);\r\n    }\r\n    _onVisibilitychange() {\r\n        if (!ILaya.stage.isVisibility) {\r\n            this._timeId = window.setInterval(this._enterFrame, 1000);\r\n        }\r\n        else if (this._timeId != 0) {\r\n            window.clearInterval(this._timeId);\r\n        }\r\n    }\r\n    initRender(canvas, w, h) {\r\n        function getWebGLContext(canvas) {\r\n            var gl;\r\n            var names = [\"webgl2\", \"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n            if (!Config.useWebGL2 || Browser.onBDMiniGame) {\r\n                names.shift();\r\n            }\r\n            for (var i = 0; i < names.length; i++) {\r\n                try {\r\n                    gl = canvas.getContext(names[i], { stencil: Config.isStencil, alpha: Config.isAlpha, antialias: Config.isAntialias, premultipliedAlpha: Config.premultipliedAlpha, preserveDrawingBuffer: Config.preserveDrawingBuffer });\r\n                }\r\n                catch (e) {\r\n                }\r\n                if (gl) {\r\n                    (names[i] === 'webgl2') && (WebGL._isWebGL2 = true);\r\n                    new LayaGL();\r\n                    return gl;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        var gl = LayaGL.instance = WebGLContext.mainContext = getWebGLContext(Render._mainCanvas.source);\r\n        if (!gl)\r\n            return false;\r\n        LayaGL.instance = gl;\r\n        LayaGL.layaGPUInstance = new LayaGPU(gl, WebGL._isWebGL2);\r\n        canvas.size(w, h);\r\n        Context.__init__();\r\n        SubmitBase.__init__();\r\n        var ctx = new Context();\r\n        ctx.isMain = true;\r\n        Render._context = ctx;\r\n        canvas._setContext(ctx);\r\n        ShaderDefines2D.__init__();\r\n        Value2D.__init__();\r\n        Shader2D.__init__();\r\n        Buffer2D.__int__(gl);\r\n        BlendMode._init_(gl);\r\n        return true;\r\n    }\r\n    _enterFrame(e = null) {\r\n        ILaya.stage._loop();\r\n    }\r\n    static get context() {\r\n        return Render._context;\r\n    }\r\n    static get canvas() {\r\n        return Render._mainCanvas.source;\r\n    }\r\n}\r\nRender.supportWebGLPlusCulling = false;\r\nRender.supportWebGLPlusAnimation = false;\r\nRender.supportWebGLPlusRendering = false;\r\nRender.isConchApp = false;\r\n{\r\n    Render.isConchApp = (window.conch != null);\r\n    if (Render.isConchApp) {\r\n        Render.supportWebGLPlusCulling = false;\r\n        Render.supportWebGLPlusAnimation = false;\r\n        Render.supportWebGLPlusRendering = false;\r\n    }\r\n    else if (window.qq != null && window.qq.webglPlus != null) {\r\n        Render.supportWebGLPlusCulling = false;\r\n        Render.supportWebGLPlusAnimation = false;\r\n        Render.supportWebGLPlusRendering = false;\r\n    }\r\n}\r\n//# sourceMappingURL=Render.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/ILaya.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/Config.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/layagl/LayaGL.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/Context.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/resource/HTMLCanvas.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/WebGL.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/WebGLContext.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/canvas/BlendMode.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/shader/d2/Shader2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/shader/d2/ShaderDefines2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/shader/d2/value/Value2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/utils/Buffer2D.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/submit/SubmitBase.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/webgl/LayaGPU.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/utils/Browser.ts"
  ],
  "map": "{\"version\":3,\"file\":\"Render.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../libs/laya/renders/Render.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/renders/Render.d.ts",
    "writeByteOrderMark": false,
    "text": "import { Context } from \"../resource/Context\";\r\nimport { HTMLCanvas } from \"../resource/HTMLCanvas\";\r\nexport declare class Render {\r\n    static _context: Context;\r\n    static _mainCanvas: HTMLCanvas;\r\n    static supportWebGLPlusCulling: boolean;\r\n    static supportWebGLPlusAnimation: boolean;\r\n    static supportWebGLPlusRendering: boolean;\r\n    static isConchApp: boolean;\r\n    static is3DMode: boolean;\r\n    constructor(width: number, height: number, mainCanv: HTMLCanvas);\r\n    private _timeId;\r\n    private _onVisibilitychange;\r\n    initRender(canvas: HTMLCanvas, w: number, h: number): boolean;\r\n    private _enterFrame;\r\n    static readonly context: Context;\r\n    static readonly canvas: any;\r\n}\r\n"
  }
}
