{
  "code": "import { Event as LayaEvent } from \"../../events/Event\";\r\nimport { SoundChannel } from \"../SoundChannel\";\r\nimport { Browser } from \"../../utils/Browser\";\r\nimport { ILaya } from \"../../../ILaya\";\r\nexport class AudioSoundChannel extends SoundChannel {\r\n    constructor(audio) {\r\n        super();\r\n        this._audio = null;\r\n        this._onEnd = this.__onEnd.bind(this);\r\n        this._resumePlay = this.__resumePlay.bind(this);\r\n        audio.addEventListener(\"ended\", this._onEnd);\r\n        this._audio = audio;\r\n    }\r\n    __onEnd(evt) {\r\n        if (this.loops == 1) {\r\n            if (this.completeHandler) {\r\n                ILaya.systemTimer.once(10, this, this.__runComplete, [this.completeHandler], false);\r\n                this.completeHandler = null;\r\n            }\r\n            this.stop();\r\n            this.event(LayaEvent.COMPLETE);\r\n            return;\r\n        }\r\n        if (this.loops > 0) {\r\n            this.loops--;\r\n        }\r\n        this.startTime = 0;\r\n        this.play();\r\n    }\r\n    __resumePlay() {\r\n        if (this._audio)\r\n            this._audio.removeEventListener(\"canplay\", this._resumePlay);\r\n        if (this.isStopped)\r\n            return;\r\n        try {\r\n            this._audio.currentTime = this.startTime;\r\n            Browser.container.appendChild(this._audio);\r\n            this._audio.play();\r\n        }\r\n        catch (e) {\r\n            this.event(LayaEvent.ERROR);\r\n        }\r\n    }\r\n    play() {\r\n        this.isStopped = false;\r\n        try {\r\n            this._audio.playbackRate = ILaya.SoundManager.playbackRate;\r\n            this._audio.currentTime = this.startTime;\r\n        }\r\n        catch (e) {\r\n            this._audio.addEventListener(\"canplay\", this._resumePlay);\r\n            return;\r\n        }\r\n        ILaya.SoundManager.addChannel(this);\r\n        Browser.container.appendChild(this._audio);\r\n        if (\"play\" in this._audio)\r\n            this._audio.play();\r\n    }\r\n    get position() {\r\n        if (!this._audio)\r\n            return 0;\r\n        return this._audio.currentTime;\r\n    }\r\n    get duration() {\r\n        if (!this._audio)\r\n            return 0;\r\n        return this._audio.duration;\r\n    }\r\n    stop() {\r\n        super.stop();\r\n        this.isStopped = true;\r\n        ILaya.SoundManager.removeChannel(this);\r\n        this.completeHandler = null;\r\n        if (!this._audio)\r\n            return;\r\n        if (\"pause\" in this._audio)\r\n            if (ILaya.Render.isConchApp) {\r\n                this._audio.stop();\r\n            }\r\n        this._audio.pause();\r\n        this._audio.removeEventListener(\"ended\", this._onEnd);\r\n        this._audio.removeEventListener(\"canplay\", this._resumePlay);\r\n        if (!ILaya.Browser.onIE) {\r\n            if (this._audio != ILaya.AudioSound._musicAudio) {\r\n                ILaya.Pool.recover(\"audio:\" + this.url, this._audio);\r\n            }\r\n        }\r\n        Browser.removeElement(this._audio);\r\n        this._audio = null;\r\n        if (ILaya.SoundManager.autoReleaseSound)\r\n            ILaya.SoundManager.disposeSoundLater(this.url);\r\n    }\r\n    pause() {\r\n        this.isStopped = true;\r\n        ILaya.SoundManager.removeChannel(this);\r\n        if (\"pause\" in this._audio)\r\n            this._audio.pause();\r\n        if (ILaya.SoundManager.autoReleaseSound)\r\n            ILaya.SoundManager.disposeSoundLater(this.url);\r\n    }\r\n    resume() {\r\n        var audio = this._audio;\r\n        if (!audio)\r\n            return;\r\n        this.isStopped = false;\r\n        if (audio.readyState == 0) {\r\n            audio.src = this.url;\r\n            audio.addEventListener(\"canplay\", this._resumePlay);\r\n            audio.load();\r\n        }\r\n        ILaya.SoundManager.addChannel(this);\r\n        if (\"play\" in audio) {\r\n            audio.play();\r\n        }\r\n    }\r\n    set volume(v) {\r\n        if (!this._audio)\r\n            return;\r\n        this._audio.volume = v;\r\n    }\r\n    get volume() {\r\n        if (!this._audio)\r\n            return 1;\r\n        return this._audio.volume;\r\n    }\r\n}\r\n//# sourceMappingURL=AudioSoundChannel.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/events/Event.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/media/SoundChannel.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/renders/Render.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/laya/utils/Browser.ts",
    "D:/widgets/LayaDataStructuresAlgorithms/libs/ILaya.ts"
  ],
  "map": "{\"version\":3,\"file\":\"AudioSoundChannel.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../libs/laya/media/h5audio/AudioSoundChannel.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/media/h5audio/AudioSoundChannel.d.ts",
    "writeByteOrderMark": false,
    "text": "import { SoundChannel } from \"../SoundChannel\";\r\nexport declare class AudioSoundChannel extends SoundChannel {\r\n    private _audio;\r\n    private _onEnd;\r\n    private _resumePlay;\r\n    constructor(audio: HTMLAudioElement);\r\n    private __onEnd;\r\n    private __resumePlay;\r\n    play(): void;\r\n    readonly position: number;\r\n    readonly duration: number;\r\n    stop(): void;\r\n    pause(): void;\r\n    resume(): void;\r\n    volume: number;\r\n}\r\n"
  }
}
