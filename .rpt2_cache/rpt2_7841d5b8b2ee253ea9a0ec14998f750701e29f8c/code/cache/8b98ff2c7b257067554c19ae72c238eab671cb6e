{
  "code": "import { ILaya } from \"../../ILaya\";\r\nexport class CallLater {\r\n    constructor() {\r\n        this._pool = [];\r\n        this._map = {};\r\n        this._laters = [];\r\n    }\r\n    _update() {\r\n        let laters = this._laters;\r\n        let len = laters.length;\r\n        if (len > 0) {\r\n            for (let i = 0, n = len - 1; i <= n; i++) {\r\n                let handler = laters[i];\r\n                this._map[handler.key] = null;\r\n                if (handler.method !== null) {\r\n                    handler.run();\r\n                    handler.clear();\r\n                }\r\n                this._pool.push(handler);\r\n                i === n && (n = laters.length - 1);\r\n            }\r\n            laters.length = 0;\r\n        }\r\n    }\r\n    _getHandler(caller, method) {\r\n        var cid = caller ? caller.$_GID || (caller.$_GID = ILaya.Utils.getGID()) : 0;\r\n        var mid = method.$_TID || (method.$_TID = (ILaya.Timer._mid++));\r\n        return this._map[cid + '.' + mid];\r\n    }\r\n    callLater(caller, method, args = null) {\r\n        if (this._getHandler(caller, method) == null) {\r\n            let handler;\r\n            if (this._pool.length)\r\n                handler = this._pool.pop();\r\n            else\r\n                handler = new LaterHandler();\r\n            handler.caller = caller;\r\n            handler.method = method;\r\n            handler.args = args;\r\n            var cid = caller ? caller.$_GID : 0;\r\n            var mid = method[\"$_TID\"];\r\n            handler.key = cid + '.' + mid;\r\n            this._map[handler.key] = handler;\r\n            this._laters.push(handler);\r\n        }\r\n    }\r\n    runCallLater(caller, method) {\r\n        var handler = this._getHandler(caller, method);\r\n        if (handler && handler.method != null) {\r\n            this._map[handler.key] = null;\r\n            handler.run();\r\n            handler.clear();\r\n        }\r\n    }\r\n}\r\nCallLater.I = new CallLater();\r\nclass LaterHandler {\r\n    clear() {\r\n        this.caller = null;\r\n        this.method = null;\r\n        this.args = null;\r\n    }\r\n    run() {\r\n        var caller = this.caller;\r\n        if (caller && caller.destroyed)\r\n            return this.clear();\r\n        var method = this.method;\r\n        var args = this.args;\r\n        if (method == null)\r\n            return;\r\n        args ? method.apply(caller, args) : method.call(caller);\r\n    }\r\n}\r\n//# sourceMappingURL=CallLater.js.map",
  "references": [
    "D:/widgets/LayaDataStructuresAlgorithms/libs/ILaya.ts"
  ],
  "map": "{\"version\":3,\"file\":\"CallLater.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../libs/laya/utils/CallLater.ts\"],\"names\":[],\"mappings\":\"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\"}",
  "dts": {
    "name": "D:/widgets/LayaDataStructuresAlgorithms/.rpt2_cache/placeholder/laya/utils/CallLater.d.ts",
    "writeByteOrderMark": false,
    "text": "export declare class CallLater {\r\n    static I: CallLater;\r\n    private _pool;\r\n    private _map;\r\n    private _laters;\r\n    _update(): void;\r\n    private _getHandler;\r\n    callLater(caller: any, method: Function, args?: any[]): void;\r\n    runCallLater(caller: any, method: Function): void;\r\n}\r\n"
  }
}
